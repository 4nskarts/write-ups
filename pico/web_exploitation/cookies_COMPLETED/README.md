# CTF Challenge Writeup: [Cookies](http://mercury.picoctf.net:29649/)

## Initial Scoop

- **CTF Name:** picoCTF
- **Author:** 4nskarts 
- **Category:** Web exploitation
- **The Challenge Prompt:** Who doesn't love cookies? Try to figure out the best one. [http://mercury.picoctf.net:29649/](http://mercury.picoctf.net:29649/)

## Let's Dive In

After I first clicked on the link and got to the website, we see a search bar with the placehoder `snickerdoodle`:

![](../../../screenshots/Pasted%20image%2020240310161116.png)

My first instinct was to check the source code by pressing `ctrl+u` on my keyboard, however, the only information I got was that we'll make a POST request to the `/search` endpoint containing a body of `name=<something>`, then redirects us to `/check` probably to check the `name` and display the result.

### Where I Started

Alright, since we have snickerdoodle as a placeholder, let's try that out.

![](../../../screenshots/Pasted%20image%2020240310161056.png)

Cool, that worked. Now let's check the developer tools and see what happens in the cookie section *(the challenge name is COOKIE, so it makes sense to check that first)*.

![](../../../screenshots/Pasted%20image%2020240310161137.png)

As you can see, a new Cookie is created by the name `name` and value `0`. 

Mhmm, What if we change the value `0` to `1`, refresh the page and see what happens. Will this give different results? Let's try.

![](../../../screenshots/Pasted%20image%2020240310161202.png)

It did! It seems to me that based on different values that we give to the `name` Cookie, we can get different results, and if we're lucky, some of these values will give back the flag.

Instead of aimlessly trying out different values though, let's figure the bounds of which values we can pass. You can do this in multiple ways, but we'll eventually see that the bounds are `0` and `28` inclusive.

Now, using the help of my friend ChatGPT, I generated a bash script that automates the work of sending **GET** requests to the `/check` endpoint with a our custom Cookie. Like this:

```bash
#!/bin/bash

# URL of the site
URL="http://mercury.picoctf.net:29649/check"

# Loop through cookie values from 0 to 29
for VALUE in {0..29}
do
    # Send HTTP request with curl
    RESPONSE=$(curl -s -b "name=$VALUE" "$URL")

    # Print the response
    echo "Response for cookie value '$VALUE':"
    echo "$RESPONSE"
    echo "---------------------------------------------"
done
```

Running `./solve.sh` gives a whole load of things, but grepping the result gives the flag immediately.

![](../../../screenshots/Pasted%20image%2020240310161304.png)

---

And there we go, the flag is: `picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}`