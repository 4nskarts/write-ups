# CTF Challenge Writeup: [Scavenger Hunt](http://mercury.picoctf.net:39698/)

## Initial Scoop

- **CTF Name:** picoCTF
- **Author:** 4nskarts 
- **Category:** Web exploitation
- **The Challenge Prompt:** There is some interesting information hidden around this site [http://mercury.picoctf.net:39698/](http://mercury.picoctf.net:39698/). Can you find it?

## Let's Dive In

After clicking on the link we're given, we're presented roughly with the same website as before *(Cookie challenge)*.

![Website Screenshot](../../../screenshots/Pasted%20image%2020240311063747.png)

Following the same strategy as before (viewing the page source) gives the first part of the flag.

![First Part of Flag](../../../screenshots/Pasted%20image%2020240311063827.png)

There we go, the first part is found. Now, just like before, we see two external resources being linked, `mycss` and `myjs`.

![External Resources](../../../screenshots/Pasted%20image%2020240311063903.png)

Checking `mycss` gives the second part.

![Second Part of Flag](../../../screenshots/Pasted%20image%2020240311063934.png)

And checking `myjs` should give the third part, but oh, it doesn't. Instead we see:

![myjs Content](../../../screenshots/Pasted%20image%2020240311064026.png)

First hunch is to check `/robots.txt`, but first, let me explain what search engines are.

Search engines are a piece of software which helps us find information on the internet. To deliver relevant results to us, the users, search engines need to do three things:
- Crawling
- Indexing
- Ranking

In order to understand what the phrase "How can I keep Google from indexing my website?" means, we first have to understand the three latter points I mentioned.

In order for search engines to deliver the information, they first need to find it first, this process is called **Crawling**. After finding the information, they need to *store* the information in a database, that's called **Indexing**, and lastly, a bit out of our scope is **Ranking** which is the algorithm SE follow to display the results of our search in a certain order.

Back to our challenge now. To keep Google, which is a search engine from indexing our website, we use a plain text file located at the root of the website called `robots.txt`. It enables us to stop **crawlers** from crawling or indexing specific URLs, i.e directories.

Enough of the loads of text you had to read. Let's move to `/robots.txt`.

![Robots.txt Content](../../../screenshots/Pasted%20image%2020240311072844.png)

Ta-da! The third part is here, but wait, unlike the last challenge, the flag isn't completed, we only have `picoCTF{th4ts_4_l0t_0f_pl4c` so far.

However, the note here isn't for show, an Apache server? What could that mean?

Alright, so an Apache server is a web server, it's essentially a software that serves web content, i.e HTML pages, images, pdf...etc, anything that can live as a web content basically. It uses the HTTP protocol, and most importantly, it's used to host web pages, blogs and build APIs.

You can learn more of this [here](https://www.youtube.com/watch?v=JhpUch6lWMw) 

After diving down a rabbit hole of trying out different combinations of `/flag, /hunt ...etc`, which was stupid, I admit Lol, I realized that web servers have to be configurable, and since they serve web pages, there has to be a configuration file somewhere. So I googled `apache server config file` and found the following directories that I can try:
- `/httpd.conf`
- `/apache2.conf`
- `/.htaccess`

The two first options didn't work, the third one though was interesting, it stated in [this website](https://www.howtogeek.com/devops/how-to-find-your-apache-configuration-folder/) that you can also configure Apache without even touching the root configuration. If the feature is enabled, Apache attempts to read a file named `.htaccess` from your site's document root (the place where you put your HTML and other site content).

Alright, let's try accessing http://mercury.picoctf.net:39698/.htaccess.

![.htaccess Content](../../../screenshots/Pasted%20image%2020240311080849.png)

No `}` character at the end of part 4, which means we still didn't complete the flag. How convenient~

Anyways, let's see the given hint, why is **Mac** and **Store** capitalized? The thing I came to do after seeing this *(and admittedly after a lot of failed attempts)* is to search for `apache "store" file mac` which gave the following:

![Search Results](../../../screenshots/Pasted%20image%2020240311082625.png)

Interesting! Let's check this article out. It says:

```
.DS_Store (Desktop Services Store) files are invisible files created by Mac OS X that contain preferences for the display of individual folders on a Mac. They tell the Finder how to display icons (their size and position), whether there is a background color in a folder window, and other information. The Finder creates a .DS_Store for every folder that is opened on a Mac, including remote folders or folders on removable media
```

This isn't a problem per Se, but Integoâ€™s researchers have found that many .DS_Store files are actually indexed by Google, which means we can access their content remotely. Of course, this vulnerability was patched in 2004 and no longer affects Apache running on Mac OS X or Mac OS X server. You can read more [here](https://www.intego.com/mac-security-blog/possible-security-issue-involving-ds_store-files-on-web-servers/)

However, this is a CTF challenge, and vulnerabilities are there on purpose. Let's check http://mercury.picoctf.net:39698/.DS_Store.

![.DS_Store Content](../../../screenshots/Pasted%20image%2020240311083204.png)

**FINALLY!** The closing bracket is there for us. We found the flag! 

---

The flag is: `picoCTF{th4ts_4_l0t_0f_pl4c3s_2_lO0k_fa04427c}`

